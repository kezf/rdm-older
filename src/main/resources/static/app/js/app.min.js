(function(a){a.extend({table:{_option:{},_params:{},init:function(b){a.table._option=b;a.table._params=a.common.isEmpty(b.queryParams)?a.table.queryParams:b.queryParams;_sortOrder=a.common.isEmpty(b.sortOrder)?"asc":b.sortOrder;_sortName=a.common.isEmpty(b.sortName)?"":b.sortName;a("#bootstrap-table").bootstrapTable({url:b.url,contentType:"application/x-www-form-urlencoded",method:"post",cache:false,sortable:true,sortStable:true,sortName:_sortName,sortOrder:_sortOrder,pagination:a.common.visible(b.pagination),pageNumber:1,pageSize:10,pageList:[10,25,50],iconSize:"outline",toolbar:"#toolbar",sidePagination:"server",search:a.common.visible(b.search),showRefresh:a.common.visible(b.showRefresh),showColumns:a.common.visible(b.showColumns),showToggle:a.common.visible(b.showToggle),showExport:a.common.visible(b.showExport),queryParams:a.table._params,columns:b.columns})},queryParams:function(b){return{pageSize:b.limit,pageNum:b.offset/b.limit+1,searchValue:b.search,orderByColumn:b.sort,isAsc:b.order}},reset:function(b){document.getElementById(b).reset();var c=a("#bootstrap-table").bootstrapTable("getOptions");a("#bootstrap-table").bootstrapTable("refresh",c)},search:function(b){var c=a("#bootstrap-table").bootstrapTable("getOptions");c.queryParams=function(e){var d={};a.each(a("#"+b).serializeArray(),function(f,g){d[g.name]=g.value});d.pageSize=e.limit;d.pageNum=e.offset/e.limit+1;d.searchValue=e.search;d.orderByColumn=e.sort;d.isAsc=e.order;return d};a("#bootstrap-table").bootstrapTable("refresh",c)},exportExcel:function(b){a.modal.loading("正在导出数据，请稍后...");a.post(a.table._option.exportUrl,a("#"+b).serializeArray(),function(c){if(c.code==web_status.SUCCESS){window.location.href=ctx+"common/download?fileName="+c.msg+"&delete="+true}else{a.modal.alertError(c.msg)}a.modal.closeLoading()})},refresh:function(){a("#bootstrap-table").bootstrapTable("refresh",{url:a.table._option.url,silent:true})},selectColumns:function(b){return a.map(a("#bootstrap-table").bootstrapTable("getSelections"),function(c){return c[b]})},selectFirstColumns:function(){return a.map(a("#bootstrap-table").bootstrapTable("getSelections"),function(b){return b[a.table._option.columns[1].field]})},selectDictLabelNoStyle:function(c,b){var d=[];a.each(c,function(e,f){if(f.dictValue==b){d.push("<span>"+f.dictLabel+"</span>");return false}});return d.join("")},selectDictLabel:function(c,b){var d=[];a.each(c,function(e,f){if(f.dictValue==b){d.push("<span class='badge badge-"+f.listClass+"'>"+f.dictLabel+"</span>");return false}});return d.join("")}},treeTable:{_option:{},_treeTable:{},init:function(c){a.table._option=c;var b=a("#bootstrap-table").bootstrapTreeTable({code:c.id,parentCode:c.parentId,type:"get",url:c.url,ajaxParams:{},expandColumn:"0",striped:false,bordered:true,expandAll:a.common.visible(c.expandAll),columns:c.columns});a.treeTable._treeTable=b},search:function(b){var c={};a.each(a("#"+b).serializeArray(),function(d,e){c[e.name]=e.value});a.treeTable._treeTable.bootstrapTreeTable("refresh",c)},refresh:function(){a.treeTable._treeTable.bootstrapTreeTable("refresh")}},form:{selectCheckeds:function(c){var b="";a('input:checkbox[name="'+c+'"]:checked').each(function(d){if(0==d){b=a(this).val()}else{b+=(","+a(this).val())}});return b},selectSelects:function(b){var c="";a("#"+b+" option:selected").each(function(d){if(0==d){c=a(this).val()}else{c+=(","+a(this).val())}});return c}},modal:{icon:function(c){var b="";if(c==modal_status.WARNING){b=0}else{if(c==modal_status.SUCCESS){b=1}else{if(c==modal_status.FAIL){b=2}else{b=3}}}return b},msg:function(c,b){if(b!=undefined){layer.msg(c,{icon:a.modal.icon(b),time:1000,shift:5})}else{layer.msg(c)}},msgError:function(b){a.modal.msg(b,modal_status.FAIL)},msgSuccess:function(b){a.modal.msg(b,modal_status.SUCCESS)},msgWarning:function(b){a.modal.msg(b,modal_status.WARNING)},alert:function(c,b){layer.alert(c,{icon:a.modal.icon(b),title:"系统提示",btn:["确认"],btnclass:["btn btn-primary"]})},msgReload:function(c,b){layer.msg(c,{icon:a.modal.icon(b),time:500,shade:[0.1,"#8F8F8F"]},function(){a.modal.reload()})},alertError:function(b){a.modal.alert(b,modal_status.FAIL)},alertSuccess:function(b){a.modal.alert(b,modal_status.SUCCESS)},alertWarning:function(b){a.modal.alert(b,modal_status.WARNING)},close:function(){var b=parent.layer.getFrameIndex(window.name);parent.layer.close(b)},confirm:function(b,c){layer.confirm(b,{icon:3,title:"系统提示",btn:["确认","取消"],btnclass:["btn btn-primary","btn btn-danger"]},function(d){layer.close(d);c(true)})},open:function(e,c,d,b){if(a.common.isEmpty(e)){e=false}if(a.common.isEmpty(c)){c="404.html"}if(a.common.isEmpty(d)){d=800}if(a.common.isEmpty(b)){b=(a(window).height()-50)}layer.open({type:2,area:[d+"px",b+"px"],fix:false,maxmin:true,shade:0.3,title:e,content:c})},openFull:function(f,d,e,b){if(a.common.isEmpty(f)){f=false}if(a.common.isEmpty(d)){d="404.html"}if(a.common.isEmpty(e)){e=800}if(a.common.isEmpty(b)){b=(a(window).height()-50)}var c=layer.open({type:2,area:[e+"px",b+"px"],fix:false,maxmin:true,shade:0.3,title:f,content:d});layer.full(c)},loading:function(b){a.blockUI({message:'<div class="loaderbox"><div class="loading-activity"></div> '+b+"</div>"})},closeLoading:function(){setTimeout(function(){a.unblockUI()},50)},reload:function(){parent.location.reload()}},operate:{submit:function(d,e,b,f){a.modal.loading("正在处理中，请稍后...");var c={url:d,type:e,dataType:b,data:f,success:function(g){a.operate.ajaxSuccess(g)}};a.ajax(c)},post:function(b,c){a.operate.submit(b,"post","json",c)},remove:function(b){a.modal.confirm("确定删除该条"+a.table._option.modalName+"信息吗？",function(){var c=a.common.isEmpty(b)?a.table._option.removeUrl:a.table._option.removeUrl.replace("{id}",b);var d={ids:b};a.operate.submit(c,"post","json",d)})},batRemove:function(){var b=a.common.isEmpty(a.table._option.id)?a.table.selectFirstColumns():a.table.selectColumns(a.table._option.id);if(b.length==0){a.modal.alertWarning("请至少选择一条记录");return}a.modal.confirm("确认要删除选中的"+b.length+"条数据吗?",function(){var c=a.table._option.removeUrl;var d={ids:b.join()};a.operate.submit(c,"post","json",d)})},clear:function(){a.modal.confirm("确定清空所有"+a.table._option.modalName+"信息吗？",function(){var b=a.table._option.clearUrl;var c={};a.operate.submit(b,"post","json",c)})},add:function(c){var b=a.common.isEmpty(c)?a.table._option.createUrl:a.table._option.createUrl.replace("{id}",c);a.modal.open("添加"+a.table._option.modalName,b)},edit:function(c){var b=a.table._option.updateUrl.replace("{id}",c);a.modal.open("修改"+a.table._option.modalName,b)},addFull:function(c){var b=a.common.isEmpty(c)?a.table._option.createUrl:a.table._option.createUrl.replace("{id}",c);a.modal.openFull("添加"+a.table._option.modalName,b)},editFull:function(c){var b=a.table._option.updateUrl.replace("{id}",c);a.modal.openFull("修改"+a.table._option.modalName,b)},save:function(c,d){a.modal.loading("正在处理中，请稍后...");var b={url:c,type:"post",dataType:"json",data:d,success:function(e){a.operate.saveSuccess(e)}};a.ajax(b)},ajaxSuccess:function(b){if(b.code==web_status.SUCCESS){a.modal.msgSuccess(b.msg);a.table.refresh()}else{a.modal.alertError(b.msg)}a.modal.closeLoading()},saveSuccess:function(b){if(b.code==web_status.SUCCESS){a.modal.msgReload("保存成功,正在刷新数据请稍后……",modal_status.SUCCESS)}else{a.modal.alertError(b.msg)}a.modal.closeLoading()}},common:{isEmpty:function(b){if(b==null||this.trim(b)==""){return true}return false},visible:function(b){if(a.common.isEmpty(b)||b==true){return true}return false},trim:function(b){if(b==null){return""}return b.toString().replace(/(^\s*)|(\s*$)|\r|\n/g,"")},random:function(c,b){return Math.floor((Math.random()*b)+c)}}})})(jQuery);web_status={SUCCESS:0,FAIL:500};modal_status={SUCCESS:"success",FAIL:"error",WARNING:"warning"};